<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Klickos Coin</title>
    <style>
        /* TEMEL STƒ∞LLER */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #111;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        /* HEADER & SCORE */
        header {
            width: 100%;
            text-align: center;
            padding: 20px 0;
        }
        #currentScore {
            font-size: 4em;
            font-weight: bold;
            color: #ffc107;
        }
        .trophy {
            font-size: 1.2em;
            color: #ccc;
            margin-top: -10px;
        }

        /* COIN ALANI */
        #main-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
        }
        #coinArea {
            width: 250px;
            height: 250px;
            border-radius: 50%;
            background: linear-gradient(145deg, #ffd700, #ff8c00);
            box-shadow: 0 0 40px rgba(255, 165, 0, 0.8), inset 0 0 20px rgba(255, 255, 255, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5em;
            color: #333;
            cursor: pointer;
            user-select: none;
            transition: transform 0.1s;
        }
        #coinArea:active {
            transform: scale(0.95);
        }

        /* ENERJƒ∞ BARI */
        .energy-status {
            width: 90%;
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .energy-bar-container {
            width: 100%;
            height: 10px;
            background: #333;
            border-radius: 5px;
            margin-top: 5px;
            overflow: hidden;
        }
        #energyBar {
            height: 100%;
            background-color: #007bff;
            transition: width 0.5s;
        }
        .energy-info {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 5px;
            font-size: 0.9em;
        }

        /* FOOTER & NAVƒ∞GASYON */
        footer {
            width: 100%;
            display: flex;
            justify-content: space-around;
            padding: 15px 0;
            background: #222;
            border-top: 1px solid #333;
        }
        .nav-button {
            background: none;
            border: none;
            color: white;
            font-size: 1em;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* MODAL STƒ∞LLERƒ∞ */
        .modal {
            display: none; 
            position: fixed;
            z-index: 10;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #2c2c2c;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            position: relative;
        }
        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            position: absolute;
            top: 10px;
            right: 20px;
            cursor: pointer;
        }
        /* Frens Listesi Stil */
        #frens-list {
            list-style: none;
            padding: 0;
        }
        #frens-list li {
            padding: 10px;
            border-bottom: 1px solid #444;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .fren-rank { font-weight: bold; width: 10%; }
        .fren-name { width: 40%; }
        .fren-score { color: #ffc107; width: 30%; text-align: right; }
        .fren-commission { color: #00ff80; width: 20%; text-align: right; font-size: 0.8em; }
        
        /* Boosts Stil */
        .boost-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #444;
        }
        .buy-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <header>
        <div id="currentScore">0</div>
        <div class="trophy">üèÜ Bronze ></div>
    </header>

    <div id="main-content">
        <div id="coinArea">KLICKOS</div>
        <div class="energy-status">
            <div class="energy-info">
                <span>‚ö° <span id="currentEnergyDisplay">1000 / 1000</span></span>
                <span>Tƒ±klama G√ºc√º: <span id="multiClickDisplay">+1</span></span>
            </div>
            <div class="energy-bar-container">
                <div id="energyBar" style="width: 100%;"></div>
            </div>
        </div>
    </div>

    <footer>
        <button id="frens-button" class="nav-button">üë• Frens</button>
        <button id="earn-button" class="nav-button">‚≠ê Earn</button>
        <button id="boosts-button" class="nav-button">üöÄ Boosts</button>
    </footer>

    <div id="frensModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('frensModal')">&times;</span>
            <h2>üë• Frens Listesi</h2>
            <ul id="frens-list">
                </ul>
            <p style="margin-top: 20px;">Arkada≈ü davet linkin: <span id="referral-link" style="color: #00ff80;">Y√ºkleniyor...</span></p>
        </div>
    </div>

    <div id="boostsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('boostsModal')">&times;</span>
            <h2>üöÄ Boosts & Maƒüaza</h2>
            <p>Mevcut Skor: <span id="boosts-current-score" style="color: #ffc107;">0</span></p>
            
            <hr style="border-color: #333; margin: 15px 0;">
            
            <h3>√úcretsiz G√ºnl√ºk Boostlar</h3>
            <div class="boost-item">
                <span>Turbo (Kalan: <span id="turbo-count-display">6</span>)</span>
                <button id="use-turbo-button" class="buy-button">Kullan (√úcretsiz)</button>
            </div>
            <div class="boost-item">
                <span>Full Energy (Kalan: <span id="energy-full-count-display">12</span>)</span>
                <button id="use-energyFull-button" class="buy-button">Kullan (√úcretsiz)</button>
            </div>

            <hr style="border-color: #333; margin: 15px 0;">

            <h3>Y√ºkseltmeler</h3>
            <div class="boost-item">
                <span>Multitap (Lvl <span id="multitap-level-display">1</span>)</span>
                <button id="buy-multitap-button" class="buy-button">Satƒ±n Al (<span id="multitap-price-display">100</span> Coin)</button>
            </div>
            </div>
    </div>

    <div id="earnModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('earnModal')">&times;</span>
            <h2>‚≠ê Earn (G√∂revler)</h2>
            <p>Bu kƒ±sƒ±m i√ßin Backend g√∂rev y√∂netimi entegrasyonu gereklidir.</p>
        </div>
    </div>

    ```

---

## 2. üíª JAVASCRIPT KOD BLOƒûU (index.html Alt Kƒ±sƒ±m)

Bu kod, yukarƒ±daki HTML yapƒ±sƒ±nƒ±n hemen altƒ±na, `</body>` etiketinden √∂nce bir `<script>` etiketi i√ßinde yer almalƒ±dƒ±r.

```html
<script>
    // ‚ö†Ô∏è API URL'Sƒ∞: Kendi Vercel Canlƒ± Uygulama Adresin.
    const VERCEL_APP_DOMAIN = 'https://klickos-backend.vercel.app'; 
    const BASE_API_URL = VERCEL_APP_DOMAIN + '/api';

    // Uygulama Deƒüi≈ükenleri
    let telegramUserId = '123456789'; // Ba≈ülangƒ±√ßta sahte ID, Telegram API ile g√ºncellenecek
    let currentScore = 0;
    let currentEnergy = 1000;
    let maxEnergy = 1000;
    let multiClickLevel = 1;
    let turboCount = 6;
    let energyFullCount = 12;

    // --- ELEMENT G√úNCELLEME FONKSƒ∞YONLARI ---

    function updateBoostsModal() {
        document.getElementById('boosts-current-score').textContent = currentScore.toLocaleString();
        document.getElementById('turbo-count-display').textContent = turboCount;
        document.getElementById('energy-full-count-display').textContent = energyFullCount;
        document.getElementById('multitap-level-display').textContent = multiClickLevel;
        
        // Fiyatƒ± g√ºncelle: √ñrn: 100 * (Level)
        const multitapPrice = 100 * multiClickLevel;
        document.getElementById('multitap-price-display').textContent = multitapPrice.toLocaleString();
        
        // Boost Butonlarƒ±nƒ± deaktive et (Limit bittiyse)
        document.getElementById('use-turbo-button').disabled = turboCount <= 0;
        document.getElementById('use-energyFull-button').disabled = energyFullCount <= 0;
    }

    function updateScoreText() {
        document.getElementById('currentScore').textContent = currentScore.toLocaleString();
        // Boosts modalƒ±nƒ± da g√ºncelle (modal a√ßƒ±k olabilir)
        if (document.getElementById('boostsModal').style.display === 'flex') {
            document.getElementById('boosts-current-score').textContent = currentScore.toLocaleString();
        }
    }

    function updateEnergyBar() {
        const energyBar = document.getElementById('energyBar');
        const percentage = (currentEnergy / maxEnergy) * 100;
        energyBar.style.width = `${percentage}%`;
        document.getElementById('currentEnergyDisplay').textContent = `${currentEnergy} / ${maxEnergy}`;
        document.getElementById('multiClickDisplay').textContent = `+${multiClickLevel}`;
    }

    // --- BACKEND API ƒ∞STEKLERƒ∞ ---

    // 1. Kullanƒ±cƒ± Verisini Y√ºkleme (Uygulama A√ßƒ±lƒ±≈üƒ±nda)
    async function loadUserData(userId) {
        try {
            const response = await fetch(`${BASE_API_URL}/user?userId=${userId}`);
            const data = await response.json();

            if (response.ok) {
                // Backend'den gelen veriyi g√ºncelle
                currentScore = data.score;
                currentEnergy = data.currentEnergy;
                multiClickLevel = data.multiClickLevel;
                turboCount = data.turboCount;
                energyFullCount = data.energyFullCount;
                
                // Frontend'i g√∂rsel olarak g√ºncelle
                updateScoreText();
                updateEnergyBar();
                updateBoostsModal(); // Boost kotalarƒ±nƒ± ve seviyeyi g√ºncelle
                
            } else {
                console.error("Veri y√ºklenemedi:", data.message);
            }
        } catch (error) {
            console.error("API baƒülantƒ± hatasƒ± (Y√ºkleme):", error);
        }
    }

    // 2. Kullanƒ±cƒ± Verisini Kaydetme (Tƒ±klama Sonrasƒ± veya Enerji Deƒüi≈üiminde)
    let saveTimeout;
    async function saveUserData() {
        // Debounce: 1 saniyede bir kaydetmeyi garantiler (√ßok sƒ±k API √ßaƒürƒ±sƒ± yapmamak i√ßin)
        clearTimeout(saveTimeout);
        saveTimeout = setTimeout(async () => {
             try {
                const response = await fetch(`${BASE_API_URL}/user`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        userId: telegramUserId,
                        score: currentScore,
                        currentEnergy: currentEnergy,
                        turboCount: turboCount,
                        energyFullCount: energyFullCount
                    }),
                });
                if (!response.ok) {
                    const data = await response.json();
                    console.error("Veri kaydetme hatasƒ±:", data.message);
                }
            } catch (error) {
                console.error("API baƒülantƒ± hatasƒ± (Kaydetme):", error);
            }
        }, 1000); // 1 saniye bekleme s√ºresi
    }

    // 3. Frens Listesini √áekme
    async function loadFrensList(userId) {
        const frensListContainer = document.getElementById('frens-list');
        frensListContainer.innerHTML = '<li>Y√ºkleniyor...</li>';
        
        try {
            const response = await fetch(`${BASE_API_URL}/frens/list?inviterId=${userId}`);
            const data = await response.json();

            if (data.success) {
                frensListContainer.innerHTML = ''; 
                if (data.frens.length === 0) {
                    frensListContainer.innerHTML = '<li>Hen√ºz davet ettiƒüiniz kimse yok!</li>';
                    return;
                }

                data.frens.forEach((fren, index) => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <div class="fren-rank">${index + 1}.</div>
                        <div class="fren-name">${fren.name}</div>
                        <div class="fren-score">${fren.score.toLocaleString()} Coin</div>
                        <div class="fren-commission">+${fren.commission.toLocaleString()} Komisyon</div>
                    `;
                    frensListContainer.appendChild(li);
                });
            } else {
                 frensListContainer.innerHTML = '<li>Liste y√ºklenemedi. Sunucu hatasƒ±.</li>';
            }
        } catch (error) {
            console.error("Frens listesi √ßekilirken hata:", error);
            frensListContainer.innerHTML = '<li>Liste y√ºklenemedi. Baƒülantƒ± hatasƒ±.</li>';
        }
    }

    // 4. Boost Satƒ±n Alma/Kullanma
    async function buyBoost(userId, itemName, price) {
        if (price > 0 && currentScore < price) {
            alert("Yeterli skorun yok!");
            return;
        }

        try {
            const response = await fetch(`${BASE_API_URL}/boosts/buy`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    userId: userId,
                    itemName: itemName,
                    price: price
                }),
            });

            const data = await response.json();

            if (data.success) {
                // Skoru, seviyeyi ve kotalarƒ± g√ºncellemek i√ßin veriyi tekrar y√ºkle
                // Backend g√ºvenliƒüini saƒülamak i√ßin bu her zaman en iyi yoldur
                loadUserData(userId); 
                
                alert("ƒ∞≈ülem ba≈üarƒ±lƒ±! " + itemName.toUpperCase() + " g√ºncellendi.");
                closeModal('boostsModal');
                
            } else {
                alert("ƒ∞≈ülem ba≈üarƒ±sƒ±z: " + data.message);
            }
        } catch (error) {
            console.error("Boost satƒ±n alma hatasƒ±:", error);
            alert("Baƒülantƒ± hatasƒ±, i≈ülem yapƒ±lamadƒ±.");
        }
    }


    // --- TEMEL UYGULAMA MANTIƒûI ---

    // 1. Tƒ±klama Olayƒ±
    function handleTap(event) {
        if (currentEnergy > 0) {
            currentScore += multiClickLevel;
            currentEnergy -= 1; 

            updateScoreText();
            updateEnergyBar();
            saveUserData(); 

            // Tƒ±klama efekti (Opsiyonel)
            // ...
        }
    }
    
    // 2. Enerji Yenileme (Her 3 saniyede 1 enerji ekler)
    setInterval(() => {
        if (currentEnergy < maxEnergy) {
            currentEnergy += 1; 
            updateEnergyBar();
            // Enerji dolduƒüunda veya belli aralƒ±klarla kaydedebiliriz
            if (currentEnergy === maxEnergy) {
                 saveUserData();
            }
        }
    }, 3000); // 3 saniyede bir (333 puan/dk)

    // --- MODAL ve EVENT HANDLERS ---

    function openModal(modalId) {
        document.getElementById(modalId).style.display = 'flex';
        // Frens modalƒ± a√ßƒ±lƒ±yorsa listeyi y√ºkle
        if (modalId === 'frensModal') {
             loadFrensList(telegramUserId);
             // Davet linkini de olu≈ütur
             document.getElementById('referral-link').textContent = `${VERCEL_APP_DOMAIN}?startapp=${telegramUserId}`;
        }
        // Boost modalƒ± a√ßƒ±lƒ±yorsa g√ºncel bilgileri yansƒ±t
        if (modalId === 'boostsModal') {
             updateBoostsModal();
        }
    }

    function closeModal(modalId) {
        document.getElementById(modalId).style.display = 'none';
    }


    // 3. Olay Dinleyicilerini Baƒülama
    function initializeEvents() {
        const coinArea = document.getElementById('coinArea');
        if (coinArea) coinArea.addEventListener('click', handleTap);

        // Footer Butonlarƒ±
        document.getElementById('frens-button').addEventListener('click', () => openModal('frensModal'));
        document.getElementById('earn-button').addEventListener('click', () => openModal('earnModal'));
        document.getElementById('boosts-button').addEventListener('click', () => openModal('boostsModal'));

        // Modal Kapatma Butonlarƒ±
        document.querySelectorAll('.close-button').forEach(button => {
            button.addEventListener('click', (e) => closeModal(e.target.closest('.modal').id));
        });

        // BOOSTS modalƒ±ndaki satƒ±n alma/kullanma butonlarƒ±nƒ± baƒüla
        document.getElementById('buy-multitap-button').addEventListener('click', () => {
            const price = 100 * multiClickLevel; 
            buyBoost(telegramUserId, 'multiClick', price);
        });

        document.getElementById('use-turbo-button').addEventListener('click', () => {
            buyBoost(telegramUserId, 'turbo', 0); // √úcretsiz
        });

        document.getElementById('use-energyFull-button').addEventListener('click', () => {
            buyBoost(telegramUserId, 'energyFull', 0); // √úcretsiz
        });
        
        // Telegram ID'sini al (Kritik: Uygulamanƒ±n Backend'i doƒüru ID ile √ßaƒüƒ±rabilmesi i√ßin)
        if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initDataUnsafe && window.Telegram.WebApp.initDataUnsafe.user) {
            telegramUserId = String(window.Telegram.WebApp.initDataUnsafe.user.id);
        } else {
            console.warn("Telegram WebApp SDK bulunamadƒ±, varsayƒ±lan ID kullanƒ±lƒ±yor.");
        }
    }
    
    // Uygulama y√ºklendiƒüinde √ßalƒ±≈ütƒ±r
    document.addEventListener('DOMContentLoaded', () => {
        initializeEvents();
        // Backend'den veriyi y√ºkle
        loadUserData(telegramUserId); 
    });
</script>
</body>
</html>
